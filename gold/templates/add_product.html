{% load static %}
<!doctype html>
<html lang="en">
    <head>

      {% comment %} NEW HEAD {% endcomment %}
      <meta charset="utf-8">
      <title>Amazima|Admin</title>
      <meta content="width=device-width, initial-scale=1.0" name="viewport">
      <meta content="" name="keywords">
      <meta content="" name="description">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

      <!-- Favicon -->
      <link href="{% static 'img/favicon.ico'%}" rel="icon">

      <!-- Google Web Fonts -->
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600&family=Inter:wght@700;800&display=swap" rel="stylesheet">
      
      <!-- Icon Font Stylesheet -->
      <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

      <!-- Libraries Stylesheet -->
      <link href=" {% static 'lib-sign/animate/animate.min.css' %}" rel="stylesheet">
      <link href="{% static 'lib-sign/owlcarousel/assets/owl.carousel.min.css' %}" rel="stylesheet">

      <!-- Customized Bootstrap Stylesheet -->
      <link href="{% static 'css-new/bootstrap.min.css' %}" rel="stylesheet">

      <!-- Template Stylesheet -->
      <link href="{% static 'css-new/style.css'%}" rel="stylesheet">
      {% comment %} END NEW HEAD  {% endcomment %}

      
      <meta charset="utf-8">
      <title>add-product</title>
      <meta content="width=device-width, initial-scale=1.0" name="viewport">
      <link rel="stylesheet" href="{% static 'admincss.css' %}">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
      <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
      <meta content="" name="keywords">
      <meta content="" name="description">
      <!-- CSS FILES -->
      <link rel="preconnect" href="https://fonts.googleapis.com">

      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

      <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;300;400;700;900&display=swap" rel="stylesheet">

      <link href="{% static 'css-sign/bootstrap.min.css' %}" rel="stylesheet">
      <link href="{% static 'css-sign/bootstrap-icons.css'%}" rel="stylesheet">

      <link rel="stylesheet" href="{% static 'css-sign/slick.css' %}"/>

      <link href="{% static 'css-sign/tooplate-little-fashion.css' %} " rel="stylesheet">

    </head>
    
    <body>

      {% include "admin_nav.html" %}
       <!-- Sidebar -->
    <div class="sidebar">
      
      <h3 class="text-light mb-4">Management</h3>
      <nav class="nav flex-column">
          <a href="{% url 'admin' %}" class="nav-link active"><i class="fas fa-home me-2"></i> Dashboard</a>
          <a href="{% url 'admin_profile' %}" class="nav-link"><i class="fas fa-user me-2"></i> Profile</a>
          <a href="#order" id="orders_click" class="nav-link"><i class="fas fa-shopping-cart me-2"></i> Order</a>
          <a href="{% url 'add_product' %}" class="nav-link"><i class="fas fa-box me-2"></i> add Product</a>
          <a href="#" class="nav-link"><i class="fas fa-box me-2"></i> Customers</a>
          <a href="#" class="nav-link"><i class="fa-regular fa-comment"></i> FeedBack</a>
          <a href="{% url 'log_out' %}" class="nav-link"><i class="fas fa-sign-out-alt me-2"></i> Logout</a>
      </nav>
  </div>
      {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{message.tags }} alert-dismissible fade show" role ="alert" style= "text-align : center;background-color: aqua;">
          <strong>
            Message:
          </strong> {{ message }}
          <button type ="button" class="close" data-dismiss="alert" aria-label="close">
          <span  aria-hidden="true"> &times;</span>
          </button>
        </div>
      {% endfor %}
    {% endif %}
        <section class="preloader">
            <div class="spinner">
                <span class="sk-inner-circle"></span>
            </div>
        </section>
    
        <main>

            <section class="sign-in-form section-padding">
                <div class="container">
                    <div class="row">

                        <div class="col-lg-8 mx-auto col-12">

                            <h1 class="hero-title text-center mb-5">ADD PRODUCTS</h1>

                          

                            <div class="row">
                                <div class="col-lg-8 col-11 mx-auto">
                                    <form role="form" method="post" action="{% url 'admin' %}" enctype="multipart/form-data">
                                          {% csrf_token %}

                                          <div class="form-floating" style='margin-bottom:10px'>
                                                <input type="text" name="product_name" id="product_name"  class="form-control" placeholder="product_name" required>
    
                                                <label for="product_name">product_name</label>
                                          </div>

                                          <div class="form-floating">

                                                <input type="text" name="cartegory" id="cartegory" class="form-control" placeholder="cartegory" required>
    
                                                <label for="price">cartegory</label>
                                            </div>

                                          <div class="form-floating" style='margin-bottom:10px'>
                                                <input type="tel" name="product_description" id="product_description"  class="form-control" placeholder="product_description" required>
    
                                                <label for="product_description">product_description</label>
                                            </div>

                                        <div class="form-floating">

                                            <input type="number" name="price" id="price" class="form-control" placeholder="price" required>

                                            <label for="price">price</label>
                                        </div>
                                        

                                        <div class="form-floating my-4">
                                            <input type="file" name="image" id="image"  class="form-control" placeholder="Image" required>

                                            <label for="image">Image</label>
                                        </div>

                                        

                                        <button type="submit" class="btn custom-btn form-control mt-4 mb-3">
                                            Add product
                                        </button>

                                       

                                    </form>
                                </div>
                            </div>

                            
                            
                        </div>

                        
                </div>
            </section>
<!-- ====================UPDATING PRODUCT=============== -->
            <div class="modal fade" id="videoModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                      <div class="modal-content rounded-0">
                          <div class="modal-header">
                              <h5 class="modal-title" id="exampleModalLabel"> Update Item </h5>
                              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                          </div>
                          <div class="modal-body">
                              <!-- 16:9 aspect ratio -->
                              <div class="ratio ratio-16x9">
                                    <div class="row">
                                          <div class="col-lg-8 col-11 mx-auto">
                                              <form role="form" method="post" action="{% url 'update' %}" enctype="multipart/form-data">
                                                    {% csrf_token %}
                                                    <div class="form-floating" style='margin-bottom:10px' >
                                                      <input type="hidden" name="product_id" id="product_id"  class="form-control" placeholder="product Id" required>
          
                                                     <!-- <label for="product_id">product_id</label> -->
                                                </div>

                                                    <div class="form-floating" style='margin-bottom:10px'>
                                                          <input type="text" name="product_name" id="product_name"  class="form-control" placeholder="product_name" required>
              
                                                          <label for="product_name">product_name</label>
                                                    </div>
          
                                                    <div class="form-floating" style='margin-bottom:10px'>
          
                                                          <input type="text" name="cartegory" id="cartegory" class="form-control" placeholder="cartegory" required>
              
                                                          <label for="price">cartegory</label>
                                                      </div>
          
                                                    <div class="form-floating" style='margin-bottom:10px'>
                                                          <input type="tel" name="product_description" id="product_description"  class="form-control" placeholder="product_description" required>
              
                                                          <label for="product_description">product_description</label>
                                                      </div>
          
                                                  <div class="form-floating">
          
                                                      <input type="number" name="price" id="price" class="form-control" placeholder="price" required>
          
                                                      <label for="price">price</label>
                                                  </div>
                                                  
          
                                                  <div class="form-floating my-4">
                                                      <input type="file" name="image" id="image"  class="form-control" placeholder="Image" required>
          
                                                      <label for="image">Image</label>
                                                  </div>
          
                                                  
          
                                                  <button type="submit" class="btn custom-btn form-control mt-4 mb-3">
                                                     Update
                                                  </button>
          
                                                 
          
                                              </form>
                                          </div>
                                      </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>

            </main>

        

        <!-- JAVASCRIPT FILES -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script src="{% static "js-sign/jquery.min.js" %} "></script>
        <script src="{% static "js-sign/bootstrap.bundle.min.js" %} "></script>
        <script src="{% static "js-sign/Headroom.js" %} "></script>
        <script src="{% static "js-sign/jQuery.headroom.js" %} "></script>
        <script src="{% static "js-sign/slick.min.js" %} "></script>
        <script src="{% static "js-sign/custom.js" %} "></script>

    </body>
    <script>

      $(document).on('click', '.update-btn', function(e) {
            e.preventDefault();
            
            // Get the item ID from the data attribute
            const product_id = $(this).data('product-id');
            
            // Set the value of the hidden input to this item ID
            $('#product_id').val(product_id);
            
            // Optionally, you can also submit the form here if you want
            //$('#updateForm').submit();
        });
        
        $(document).on('click', '.delete', function(e) {
            e.preventDefault();
            
            // Get the product ID from the data attribute of the clicked button
            var product_id = $(this).data('product-id');
        
            $.ajax({
                type: 'POST',
                url: '{% url "delete" %}',
                data: {
                    product_id: product_id,
                    csrfmiddlewaretoken: '{{ csrf_token }}',
                    action: 'post'
                },
                success: function(json) {
                    console.log(json);
                },
                error: function(xhr, errmsg, err) {
                    console.error(errmsg);
                }
            });

            location.reload()
        });  


       {% comment %} $(document).on('click', '.delete', function(e) {
            e.preventDefault();
        
            var product_id = $(this).data('product-id');
            console.log("Product ID:", product_id); // Debugging log
        
            fetch('{% url "delete" %}', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: JSON.stringify({ 
                    product_id: product_id, 
                    action: 'post' 
                })
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();  
            })
            .then(data => {
                console.log("Response Data:", data);
                location.reload();
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });  {% endcomment %}
        
        

        
          
    </script>
</html>
